# 剪贴板朗读增强

本插件对剪贴板和刚听到的内容（即 NVDA 最后一次朗读的内容）做了增强支持，包括拷贝、追加、粘贴、单词解释以及按相应单位导航等功能。

## 兼容性
- 兼容 NVDA 2019.3 及以上；

下表列出了相关功能的默认快捷键，您可以在 NVDA 的“输入首饰”对话框中更改这些默认快捷键。

## 快捷键表

记忆技巧：

1. 笔记本方案使用基本组合键加四个箭头实现成对的功能；
2. 台式机方案使用基本组合键加数字小键盘区域实现相应功能；
3. 台式机方案小键盘区域与 NVDA 文本查看命令的快捷键高度类似，即小键盘区域的7、9为上/下一行； 4、6为上/下一词句； 1、3为上/下一字。

**提示： 下表可用 NVDA 的表格导航命令 CTRL + Alt +箭头查阅**

| 名称 | 台式机方案 | 笔记本方案 |
| --- | --- | --- |
| 编辑文档标记开始点 | windows+小键盘 4 | NVDA+alt+[ |
| 编辑文档标记结束点 | windows+小键盘 6 | NVDA+alt+] |
| 编辑文档的当前光标位置 | windows+小键盘 5 | NVDA+alt+\ |
| 编辑文档的字数统计 | windows+小键盘删除 | NVDA+alt+= |
| 刚听到内容的上一个字 | ctrl+windows+小键盘 1 | NVDA+windows+左光标 |
| 刚听到内容的当前字（双击解释） | ctrl+windows+小键盘 2 | NVDA+windows+. |
| 刚听到内容的下一个字 | ctrl+windows+小键盘 3 | NVDA+windows+右光标 |
| 刚听到内容的上一个词句 | ctrl+windows+小键盘 4 | NVDA+windows+shift+左光标 |
| 刚听到内容的当前词句（解释英文单词） | ctrl+windows+小键盘 5 | NVDA+windows+shift+. |
| 刚听到内容的下一个词句 | ctrl+windows+小键盘 6 | NVDA+windows+shift+右光标 |
| 拷贝刚听到的内容到剪贴板 | NVDA+c | NVDA+c |
| 粘贴刚听到的内容到当前光标位置 | NVDA+Shift+V | NVDA+Shift+V |
| 追加刚听到的内容到剪贴板 | NVDA+d | NVDA+d |
| 追加已选择的内容到剪贴板 | NVDA+Alt+a | NVDA+Alt+a |
| 重复朗读刚听到的内容 | 未分配 | 未分配 |
| 剪贴板第一行 | ctrl+小键盘 斜杠 | NVDA+alt+shift+上光标 |
| 剪贴板最后一行 | ctrl+小键盘 星号 | NVDA+alt+shift+下光标 |
| 剪贴板向上十行 | ctrl+小键盘 加号 | NVDA+alt+shift+上翻页 |
| 剪贴板向下十行 | ctrl+小键盘 减号 | NVDA+alt+shift+下翻页 |
| 剪贴板上一行 | ctrl+小键盘 7 | NVDA+alt+上光标 |
| 从剪贴板当前行向下朗读 | ctrl+小键盘 8 | NVDA+alt+l |
| 剪贴板的下一行 | ctrl+小键盘 9 | NVDA+alt+下光标 |
| 剪贴板上一个词句 | ctrl+小键盘 4 | NVDA+alt+shift+左光标 |
| 剪贴板当前词句（解释英文单词） | ctrl+小键盘 5 | NVDA+alt+shift+. |
| 剪贴板下一个词句 | ctrl+小键盘 6 | NVDA+alt+shift+右光标 |
| 剪贴板上一个字 | ctrl+小键盘 1 | NVDA+alt+左光标 |
| 剪贴板当前字（双击解释） | ctrl+小键盘 2 | NVDA+alt+. |
| 剪贴板下一个字 | ctrl+小键盘 3 | NVDA+alt+右光标 |
| 剪贴板综述 | ctrl+数字键盘删除 | NVDA+alt+' |
| 打开剪贴板编辑器 | NVDA+E | NVDA+E |
| 朗读农历时间 | NVDA+f11 | NVDA+f11 |
| 打开URL | ctrl+数字键盘 回车 | NVDA+alt+回车 |

## 贡献者
- 大可 （主要开发者）；
- Eureka （协助开发者）；
- 永远的星光 （代码贡献者）；
- 好奇的 01 （代码贡献者）；
- 1eez （词典数据提供者）

## V2.0 更新日志
*本版代码全部重写。*

1. 剪贴板监控改为再插件内部实现，基于此全面优化剪贴板的详细访问逻辑：
    - 当剪贴板内是文件时，按综述剪贴板的快捷键，可以朗读相关的文件数量及大小等信息。
    - 当剪贴板内是文件时，按逐行访问的快捷键，可以依次听取文件名称和路径，并且会给出音效提示，以与剪贴板内文本相区分。
2. 访问剪贴板，移动到首尾以及逐字词跨行时，增加音效提示；
3. 访问刚听到的内容，移动到首尾时，增加音效提示；
4. 尝试修复混合使用逐字词访问剪贴板，偶尔出现位置错乱的情况；
5. 优化NVDA+F12朗读时间日期的详细程度；
6. CTRL+numpad8，改为从剪贴板当前行向下朗读；
7. 增加使用 NVDA + Alt + A 将以选文本追加到剪贴板的功能；
8. 兼容 NVDA 2021.1 ；
9. 在逐字导航刚听到的内容过程中，使词句位置跟随；
10. 修复当剪贴板编辑器内无内容时“更新”和“更新并关闭”无效的 Bug ；
11. 为剪贴板编辑器的“查找”、“替换”对话框内的按钮添加了加速键；
12. 在不支持编辑文档字数统计，不支持编辑文档选择开始 / 结束点以及不支持查看编辑文档当前位置等场景下给出提示；
13. 增加粘贴刚听到的内容到当前光标位置 NVDA + Shift + V ；
14. 更换了全新的本地词典数据库，将词条数目增加到 10 万以上；
15. 剪贴板编辑器默认将以最大化显示；
16. 其他的一些细节优化。

---

## V1.2.5 更新日志
1. 修正剪贴板监控程序的调用方式，避免进程驻留。
2. 重写剪贴板监控，解决文件大小统计错误的问题；
    - PS： 感谢小康老师编写的剪贴板监控程序。

## V1.2.2 更新日志
1. 修正在某些日期获取不到农历节气信息；
2. 剪贴板内移动字词时可跨行移动。

## V1.2 更新日志
1. 增加对连续英文单词的拆分支持，比如： "GetWindowLong" 使用上/下一个词句浏览可拆分为 "Get"、"Window"、"Long"；
2. 快捷键浏览剪贴板时可记忆焦点位置；
3. 增强打开URL的能力，增加了对于 "nvdaremote://"（NVDA 远程链接协议）的支持。
4. 集成了沉浮老师的剪贴板监控程序。

## V1.0 更新日志
1. 增加对剪贴板内容更详细的访问：
    - 上、下、当前词句（解释英文单词）；
    - 上、下、当前字（双击解释）；
2. 增加打开URL功能（代码来自好奇的 01）。
3. 词句切换后将逐字移动的焦点放置在词句的开始处，便于拼读。
4. 重新设计了默认快捷键：
    - 增加笔记本方案；
    - 避免占用 NVDA 本身快捷键；
5. 可在插件管理器点“帮助”按钮查看使用说明。
